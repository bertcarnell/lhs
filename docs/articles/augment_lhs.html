<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>An Example of Augmenting a Latin Hypercube • lhs</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="An Example of Augmenting a Latin Hypercube">
<meta property="og:description" content="lhs">
<meta property="og:image" content="/logo.svg">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">lhs</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.1.7</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/augment_lhs.html">An Example of Augmenting a Latin Hypercube</a>
    </li>
    <li>
      <a href="../articles/correlated_lhs.html">Examples of Correlated and Multivariate Latin hypercubes</a>
    </li>
    <li>
      <a href="../articles/lhs_basics.html">Basic Latin hypercube samples and designs with package lhs</a>
    </li>
    <li>
      <a href="../articles/lhs_faq.html">Latin Hypercube Samples - Questions</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/bertcarnell/lhs/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>An Example of Augmenting a Latin Hypercube</h1>
                        <h4 data-toc-skip class="author">Rob
Carnell</h4>
            
            <h4 data-toc-skip class="date">2024-06-30</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/bertcarnell/lhs/blob/HEAD/vignettes/augment_lhs.Rmd" class="external-link"><code>vignettes/augment_lhs.Rmd</code></a></small>
      <div class="hidden name"><code>augment_lhs.Rmd</code></div>

    </div>

    
    
<p>Suppose that a computer simulation study is being designed that
requires expensive runs. A Latin hypercube design is desired for this
simulation so that the expectation of the simulation output can be
estimated efficiently given the distributions of the input variables.
Latin hypercubes are most often used in highly dimensional problems, but
the example shown is of small dimension. Suppose further that the total
extent of funding is uncertain. Enough money is available for 5 runs,
and there is a chance that there will be enough for 5 more. However, if
the money for the additional 5 runs does not materialize, then the first
5 runs must be a Latin hypercube alone. A design for this situation can
be created using the <code>lhs</code> package.</p>
<p>First create a random Latin hypercube using the
<code>randomLHS(n, k)</code> command:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">A</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/randomLHS.html">randomLHS</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p>An example of this hypercube is shown in <a href="#X">Figure 1</a>.
Note that the <em>Latin</em> property of the hypercube requires that
each of the 5 equal probability intervals be filled (i.e. each row and
each column is filled with one point). Also notice that the exact
location of the design point is randomly sampled from within that cell
using a uniform distribution for each marginal variable.</p>
<table style="width:8%;" class="table">
<colgroup><col width="8%"></colgroup>
<tbody>
<tr class="odd">
<td></td>
</tr>
<tr class="even">
<td><img src="augment_lhs_files/figure-html/original5-1.png" width="480" style="display: block; margin: auto;"></td>
</tr>
</tbody>
</table>
<p>Next, in order to augment the design with more points use
<code>augmentLHS(lhs, m)</code>. The following will add 5 more points to
the design:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">B</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/augmentLHS.html">augmentLHS</a></span><span class="op">(</span><span class="va">A</span>, <span class="fl">5</span><span class="op">)</span></span></code></pre></div>
<p>The <code>augmentLHS</code> function works by re-dividing the
original design into <code>n+m</code> intervals (e.g. 5+5=10) keeping
the original design points exactly in the same position. It then
randomly fills the empty row-column sets. The results are shown in
<a href="#Y">Figure 2</a>.</p>
<table style="width:8%;" class="table">
<colgroup><col width="8%"></colgroup>
<tbody>
<tr class="odd">
<td></td>
</tr>
<tr class="even">
<td><img src="augment_lhs_files/figure-html/augmented10-1.png" width="480" style="display: block; margin: auto;"></td>
</tr>
</tbody>
</table>
<p>The <code>augmentLHS</code> function uses the following algorithm
(see the documentation for <code>augmentLHS</code>):</p>
<ul>
<li>Create a new <code>(n+m)</code> by <code>k</code> matrix to hold the
candidate points after the design has been re-partitioned into
<code>(n+m)^2</code> cells, where <code>n</code> is number of points in
the original <code>lhs</code> matrix.</li>
<li>Then randomly sweep through each column (1…<code>k</code>) in the
repartitioned design to find the missing cells.</li>
<li>For each column (variable), randomly search for an empty row,
generate a random value that fits in that row, record the value in the
new matrix. The new matrix can contain more than <code>m</code> points
unless <code>m = 2n</code>, in which case the new matrix will contain
exactly <code>m</code> filled rows.</li>
<li>Finally, keep only the first <code>m</code> rows of the new matrix.
It is guaranteed that there will be <code>m</code> full rows (points) in
the new matrix. The deleted rows are partially full. The additional
candidate points are selected randomly because of the random search used
to find empty cells.</li>
</ul>
<p>Also notice that because the original points are randomly placed
within the cells, depending on how you bin the marginal distributions, a
histogram (of x1 for example) will not necessarily be exactly
uniform.</p>
<p>Now, the augmenting points do not necessarily form a Latin Hypercube
themselves. The original design and augmenting points may form a Latin
Hypercube, or there may be more than one point per row in the augmented
design. If the augmented points are equal to the number of original
points, then a strictly uniform Latin hypercube is guaranteed. An
example of an augmented design which is not uniform in the marginal
distributions is given in <a href="#Z">Figure 3</a> and
<a href="#W">Figure 4</a>. The commands were:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">A</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/randomLHS.html">randomLHS</a></span><span class="op">(</span><span class="fl">7</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">B</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/augmentLHS.html">augmentLHS</a></span><span class="op">(</span><span class="va">A</span>, <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<table style="width:8%;" class="table">
<colgroup><col width="8%"></colgroup>
<tbody>
<tr class="odd">
<td></td>
</tr>
<tr class="even">
<td><img src="augment_lhs_files/figure-html/Z-1.png" width="480" style="display: block; margin: auto;"></td>
</tr>
</tbody>
</table>
<div id="W" style="text-align:center;text-size:11pt;font-weight:bold">
Figure 4. Augmented design with 3 additional points. Note that row 9 has
2 points and row 3 has none.
</div>
<p><img src="augment_lhs_files/figure-html/W-1.png" width="480" style="display: block; margin: auto;"></p>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Rob Carnell.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
