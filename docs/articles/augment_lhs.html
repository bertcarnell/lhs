<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>An Example of Augmenting a Latin Hypercube • lhs</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="An Example of Augmenting a Latin Hypercube">
<meta property="og:description" content="">
<meta property="og:image" content="/logo.png">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">lhs</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/augment_lhs.html">An Example of Augmenting a Latin Hypercube</a>
    </li>
    <li>
      <a href="../articles/lhs_basics.html">Basic Latin hypercube samples and designs with package lhs</a>
    </li>
    <li>
      <a href="../articles/lhs_faq.html">Latin Hypercube Samples - Questions</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/bertcarnell/lhs">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>An Example of Augmenting a Latin Hypercube</h1>
                        <h4 class="author">Rob Carnell</h4>
            
            <h4 class="date">2019-02-10</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/bertcarnell/lhs/blob/master/vignettes/augment_lhs.Rmd"><code>vignettes/augment_lhs.Rmd</code></a></small>
      <div class="hidden name"><code>augment_lhs.Rmd</code></div>

    </div>

    
    
<p>Suppose that a computer simulation study is being designed that requires expensive runs. A Latin hypercube design is desired for this simulation so that the expectation of the simulation output can be estimated efficiently given the distributions of the input variables. Latin hypercubes are most often used in highly dimensional problems, but the example shown is of small dimension. Suppose further that the total extent of funding is uncertain. Enough money is available for 5 runs, and there is a chance that there will be enough for 5 more. However, if the money for the additional 5 runs does not materialize, then the first 5 runs must be a Latin hypercube alone. A design for this situation can be created using the <code>lhs</code> package.</p>
<p>First create a random Latin hypercube using the <code><a href="../reference/randomLHS.html">randomLHS(n, k)</a></code> command:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">A &lt;-<span class="st"> </span><span class="kw"><a href="../reference/randomLHS.html">randomLHS</a></span>(<span class="dv">5</span>,<span class="dv">2</span>)</code></pre></div>
<p>An example of this hypercube is shown in <a href="#X">Figure 1</a>. Note that the <em>Latin</em> property of the hypercube requires that each of the 5 equal probability intervals be filled (i.e. each row and each column is filled with one point). Also notice that the exact location of the design point is randomly sampled from within that cell using a uniform distribution for each marginal variable.</p>
<hr>
<div id="X" style="text-align:center;text-size:11pt;font-weight:bold">
Figure 1. A randomly produced Latin Hypercube with uniform marginal distributions for 2 parameters with 5 simulations
</div>
<div id="section" class="section level2">
<h2 class="hasAnchor">
<a href="#section" class="anchor"></a><img src="augment_lhs_files/figure-html/original5-1.png" width="480" style="display: block; margin: auto;">
</h2>
<p>Next, in order to augment the design with more points use <code><a href="../reference/augmentLHS.html">augmentLHS(lhs, m)</a></code>. The following will add 5 more points to the design:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">B &lt;-<span class="st"> </span><span class="kw"><a href="../reference/augmentLHS.html">augmentLHS</a></span>(A, <span class="dv">5</span>)</code></pre></div>
<p>The <code>augmentLHS</code> function works by re-dividing the original design into <code>n+m</code> intervals (e.g. 5+5=10) keeping the original design points exactly in the same position. It then randomly fills the empty row-column sets. The results are shown in <a href="#Y">Figure 2</a>.</p>
<hr>
<div id="Y" style="text-align:center;text-size:11pt;font-weight:bold">
Figure 2. A randomly produced Latin Hypercube of 5 points (red) with 5 augmented points (blue). Each parameter has a uniform marginal distribution.
</div>
</div>
<div id="section-1" class="section level2">
<h2 class="hasAnchor">
<a href="#section-1" class="anchor"></a><img src="augment_lhs_files/figure-html/augmented10-1.png" width="480" style="display: block; margin: auto;">
</h2>
<p>The <code>augmentLHS</code> function uses the following algorithm (see the documentation for <code>augmentLHS</code>):</p>
<ul>
<li>Create a new <code>(n+m)</code> by <code>k</code> matrix to hold the candidate points after the design has been re-partitioned into <code>(n+m)^2</code> cells, where <code>n</code> is number of points in the original <code>lhs</code> matrix.</li>
<li>Then randomly sweep through each column (1…<code>k</code>) in the repartitioned design to find the missing cells.</li>
<li>For each column (variable), randomly search for an empty row, generate a random value that fits in that row, record the value in the new matrix. The new matrix can contain more than <code>m</code> points unless <code>m = 2n</code>, in which case the new matrix will contain exactly <code>m</code> filled rows.</li>
<li>Finally, keep only the first <code>m</code> rows of the new matrix. It is guaranteed that there will be <code>m</code> full rows (points) in the new matrix. The deleted rows are partially full. The additional candidate points are selected randomly because of the random search used to find empty cells.</li>
</ul>
<p>Also notice that because the original points are randomly placed within the cells, depending on how you bin the marginal distributions, a histogram (of x1 for example) will not necessarily be exactly uniform.</p>
<p>Now, the augmenting points do not necessarily form a Latin Hypercube themselves. The original design and augmenting points may form a Latin Hypercube, or there may be more than one point per row in the augmented design. If the augmented points are equal to the number of original points, then a strictly uniform Latin hypercube is guaranteed. An example of an augmented design which is not uniform in the marginal distributions is given in <a href="#Z">Figure 3</a> and <a href="#W">Figure 4</a>. The commands were:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">A &lt;-<span class="st"> </span><span class="kw"><a href="../reference/randomLHS.html">randomLHS</a></span>(<span class="dv">7</span>, <span class="dv">2</span>)
B &lt;-<span class="st"> </span><span class="kw"><a href="../reference/augmentLHS.html">augmentLHS</a></span>(A, <span class="dv">3</span>)</code></pre></div>
<hr>
<div id="Z" style="text-align:center;text-size:11pt;font-weight:bold">
Figure 3. Original design with 7 points
</div>
</div>
<div id="section-2" class="section level2">
<h2 class="hasAnchor">
<a href="#section-2" class="anchor"></a><img src="augment_lhs_files/figure-html/Z-1.png" width="480" style="display: block; margin: auto;">
</h2>
<div id="W" style="text-align:center;text-size:11pt;font-weight:bold">
Figure 4. Augmented design with 3 additional points. Note that row 9 has 2 points and row 3 has none.
</div>
<p><img src="augment_lhs_files/figure-html/W-1.png" width="480" style="display: block; margin: auto;"></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#section"><img src="augment_lhs_files/figure-html/original5-1.png" width="480" style="display: block; margin: auto;"></a></li>
      <li><a href="#section-1"><img src="augment_lhs_files/figure-html/augmented10-1.png" width="480" style="display: block; margin: auto;"></a></li>
      <li><a href="#section-2"><img src="augment_lhs_files/figure-html/Z-1.png" width="480" style="display: block; margin: auto;"></a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Rob Carnell.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
