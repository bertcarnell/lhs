<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Examples of Correlated and Multivariate Latin hypercubes â€¢ lhs</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Examples of Correlated and Multivariate Latin hypercubes">
<meta property="og:description" content="lhs">
<meta property="og:image" content="/logo.svg">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">lhs</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.2.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/augment_lhs.html">An Example of Augmenting a Latin Hypercube</a>
    </li>
    <li>
      <a href="../articles/correlated_lhs.html">Examples of Correlated and Multivariate Latin hypercubes</a>
    </li>
    <li>
      <a href="../articles/lhs_basics.html">Basic Latin hypercube samples and designs with package lhs</a>
    </li>
    <li>
      <a href="../articles/lhs_faq.html">Latin Hypercube Samples - Questions</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/bertcarnell/lhs/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Examples of Correlated and Multivariate Latin
hypercubes</h1>
                        <h4 data-toc-skip class="author">Rob
Carnell</h4>
            
            <h4 data-toc-skip class="date">2024-06-30</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/bertcarnell/lhs/blob/HEAD/vignettes/correlated_lhs.Rmd" class="external-link"><code>vignettes/correlated_lhs.Rmd</code></a></small>
      <div class="hidden name"><code>correlated_lhs.Rmd</code></div>

    </div>

    
    
<p>Generally, Latin hypercubes are drawn in a way that makes the
marginal distributions for the uniform Latin hypercube and transformed
Latin hypercube independent. In some cases researches want to use Latin
hypercubes to study problem areas where the marginal distributions are
correlated or come from a multivariate distribution.</p>
<p>There are a variety of methods to create such a Latin hypercube. The
method used in this package is to draw and transform an uncorrelated
hypercube and then use the columnwise-pairwise algorithm to adjust to a
set of pre-defined conditions. A set of predefined conditions are not
always achievable.</p>
<div class="section level2">
<h2 id="example-1-simple-correlation">Example 1: Simple Correlation<a class="anchor" aria-label="anchor" href="#example-1-simple-correlation"></a>
</h2>
<p>Assumptions:</p>
<ul>
<li><span class="math inline">\(X_1 \sim uniform(2, 4)\)</span></li>
<li><span class="math inline">\(X_2 \sim Normal(1, 3)\)</span></li>
<li><span class="math inline">\(X_3 \sim Exponential(3)\)</span></li>
<li><span class="math inline">\(X_4 \sim LogNormal(1, 1)\)</span></li>
<li><span class="math inline">\(cor(x_1, x_2) = 0.3\)</span></li>
<li><span class="math inline">\(cor(x_3, x_4) = 0.5\)</span></li>
</ul>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lhs_A</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/correlatedLHS.html">correlatedLHS</a></span><span class="op">(</span><span class="fu">lhs</span><span class="fu">::</span><span class="fu"><a href="../reference/randomLHS.html">randomLHS</a></span><span class="op">(</span><span class="fl">30</span>, <span class="fl">4</span><span class="op">)</span>,</span>
<span>                       marginal_transform_function <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">W</span>, <span class="va">...</span><span class="op">)</span> <span class="op">{</span></span>
<span>                         <span class="va">W</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">qunif</a></span><span class="op">(</span><span class="va">W</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, <span class="fl">2</span>, <span class="fl">4</span><span class="op">)</span></span>
<span>                         <span class="va">W</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">qnorm</a></span><span class="op">(</span><span class="va">W</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>, <span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span></span>
<span>                         <span class="va">W</span><span class="op">[</span>,<span class="fl">3</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Exponential.html" class="external-link">qexp</a></span><span class="op">(</span><span class="va">W</span><span class="op">[</span>,<span class="fl">3</span><span class="op">]</span>, <span class="fl">3</span><span class="op">)</span></span>
<span>                         <span class="va">W</span><span class="op">[</span>,<span class="fl">4</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Lognormal.html" class="external-link">qlnorm</a></span><span class="op">(</span><span class="va">W</span><span class="op">[</span>,<span class="fl">4</span><span class="op">]</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span></span>
<span>                         <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">W</span><span class="op">)</span></span>
<span>                       <span class="op">}</span>,</span>
<span>                       cost_function <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">W</span>, <span class="va">...</span><span class="op">)</span> <span class="op">{</span></span>
<span>                         <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">W</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, <span class="va">W</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span> <span class="op">-</span> <span class="fl">0.3</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">W</span><span class="op">[</span>,<span class="fl">3</span><span class="op">]</span>, <span class="va">W</span><span class="op">[</span>,<span class="fl">4</span><span class="op">]</span><span class="op">)</span> <span class="op">-</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span></span>
<span>                       <span class="op">}</span>,</span>
<span>                       debug <span class="op">=</span> <span class="cn">FALSE</span>, maxiter <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span></code></pre></div>
<p>Check that the desired correlations were created:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">lhs_A</span><span class="op">$</span><span class="va">transformed_lhs</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1] 0.3000406</span></span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">lhs_A</span><span class="op">$</span><span class="va">transformed_lhs</span><span class="op">[</span>,<span class="fl">3</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1] 0.4998679</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="example-2-dirichlet-distribution">Example 2: Dirichlet distribution<a class="anchor" aria-label="anchor" href="#example-2-dirichlet-distribution"></a>
</h2>
<p>Assume that we want <span class="math inline">\(X\)</span> to be
Dirichlet distributed with <span class="math inline">\(\alpha =
4,3,2,1\)</span></p>
<p>Therefore the margins of the Dirichlet are:</p>
<ul>
<li><span class="math inline">\(X_1 ~ beta(4, 10-4)\)</span></li>
<li><span class="math inline">\(X_2 ~ beta(3, 10-3)\)</span></li>
<li><span class="math inline">\(X_3 ~ beta(2, 10-2)\)</span></li>
<li><span class="math inline">\(X_4 ~ beta(1, 10-1)\)</span></li>
</ul>
<div class="section level3">
<h3 id="method-1-correlatedlhs">Method 1: <code>correlatedLHS</code><a class="anchor" aria-label="anchor" href="#method-1-correlatedlhs"></a>
</h3>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lhs_B</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/correlatedLHS.html">correlatedLHS</a></span><span class="op">(</span><span class="fu">lhs</span><span class="fu">::</span><span class="fu"><a href="../reference/randomLHS.html">randomLHS</a></span><span class="op">(</span><span class="fl">30</span>, <span class="fl">4</span><span class="op">)</span>,</span>
<span>                       marginal_transform_function <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">W</span>, <span class="va">...</span><span class="op">)</span> <span class="op">{</span></span>
<span>                         <span class="va">W</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Beta.html" class="external-link">qbeta</a></span><span class="op">(</span><span class="va">W</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, <span class="fl">4</span>, <span class="fl">6</span><span class="op">)</span></span>
<span>                         <span class="va">W</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Beta.html" class="external-link">qbeta</a></span><span class="op">(</span><span class="va">W</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>, <span class="fl">3</span>, <span class="fl">7</span><span class="op">)</span></span>
<span>                         <span class="va">W</span><span class="op">[</span>,<span class="fl">3</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Beta.html" class="external-link">qbeta</a></span><span class="op">(</span><span class="va">W</span><span class="op">[</span>,<span class="fl">3</span><span class="op">]</span>, <span class="fl">2</span>, <span class="fl">8</span><span class="op">)</span></span>
<span>                         <span class="va">W</span><span class="op">[</span>,<span class="fl">4</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Beta.html" class="external-link">qbeta</a></span><span class="op">(</span><span class="va">W</span><span class="op">[</span>,<span class="fl">4</span><span class="op">]</span>, <span class="fl">1</span>, <span class="fl">9</span><span class="op">)</span></span>
<span>                         <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">W</span><span class="op">)</span></span>
<span>                       <span class="op">}</span>,</span>
<span>                       cost_function <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">W</span>, <span class="va">...</span><span class="op">)</span> <span class="op">{</span></span>
<span>                         <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">W</span>, <span class="fl">1</span>, <span class="va">sum</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></span>
<span>                       <span class="op">}</span>,</span>
<span>                       debug <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                       maxiter <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span></code></pre></div>
<p>Check properties</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">lhs_B</span><span class="op">$</span><span class="va">transformed_lhs</span>, <span class="fl">1</span>, <span class="va">sum</span><span class="op">)</span><span class="op">)</span> <span class="co"># close to 1</span></span>
<span><span class="co">#&gt; [1] 0.9625536 1.0504560</span></span></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">lhs_B</span><span class="op">$</span><span class="va">transformed_lhs</span>, <span class="fl">2</span>, <span class="va">mean</span><span class="op">)</span> <span class="co"># close to 4/10, 3/10, 2/10, 1/10</span></span>
<span><span class="co">#&gt; [1] 0.40054562 0.30170254 0.20228521 0.09803438</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="method-2-q_dirichlet">Method 2: <code>q_dirichlet</code><a class="anchor" aria-label="anchor" href="#method-2-q_dirichlet"></a>
</h3>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lhs_B</span> <span class="op">&lt;-</span> <span class="fu">lhs</span><span class="fu">::</span><span class="fu"><a href="../reference/quanttrans.html">qdirichlet</a></span><span class="op">(</span><span class="fu">lhs</span><span class="fu">::</span><span class="fu"><a href="../reference/randomLHS.html">randomLHS</a></span><span class="op">(</span><span class="fl">30</span>, <span class="fl">4</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">3</span>,<span class="fl">2</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Check properties</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/all.html" class="external-link">all</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">lhs_B</span>, <span class="fl">1</span>, <span class="va">sum</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span> <span class="op">&lt;</span> <span class="fl">1E-9</span><span class="op">)</span> <span class="co"># all exactly 1</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">lhs_B</span>, <span class="fl">2</span>, <span class="va">mean</span><span class="op">)</span> <span class="co"># close to 4/10, 3/10, 2/10, 1/10</span></span>
<span><span class="co">#&gt; [1] 0.4008212 0.3024493 0.1938541 0.1028755</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="example-3-rejection-sample">Example 3: Rejection Sample<a class="anchor" aria-label="anchor" href="#example-3-rejection-sample"></a>
</h2>
<p>Assumptions:</p>
<ul>
<li><span class="math inline">\(X_1 \sim uniform(1, 4)\)</span></li>
<li><span class="math inline">\(X_2 \sim uniform(10^{-6},
2)\)</span></li>
<li><span class="math inline">\(X_3 \sim uniform(2, 6)\)</span></li>
<li><span class="math inline">\(X_4 \sim uniform(10^{-6},
0.1)\)</span></li>
<li><span class="math inline">\(lower &lt; \prod_{i=1}^4 X_i &lt;
upper\)</span></li>
</ul>
<p>First build an empirical sample using rejection sampling</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">3803</span><span class="op">)</span></span>
<span><span class="va">N</span> <span class="op">&lt;-</span> <span class="fl">100000</span></span>
<span></span>
<span><span class="va">reject_samp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  v1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">N</span>, <span class="fl">1</span>, <span class="fl">4</span><span class="op">)</span>,</span>
<span>  v2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">N</span>, <span class="fl">1E-6</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>  v3 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">N</span>, <span class="fl">2</span>, <span class="fl">6</span><span class="op">)</span>,</span>
<span>  v4 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">N</span>, <span class="fl">1E-6</span>, <span class="fl">0.1</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">reject_samp</span>, <span class="va">v1</span><span class="op">*</span><span class="va">v2</span><span class="op">*</span><span class="va">v3</span><span class="op">*</span><span class="va">v4</span><span class="op">)</span></span>
<span><span class="va">ind</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">p</span> <span class="op">&lt;</span> <span class="fl">1</span> <span class="op">&amp;</span> <span class="va">p</span> <span class="op">&gt;</span> <span class="fl">0.3</span><span class="op">)</span></span>
<span><span class="va">reject_samp</span> <span class="op">&lt;-</span> <span class="va">reject_samp</span><span class="op">[</span><span class="va">ind</span>,<span class="op">]</span></span></code></pre></div>
<p>Now build the correlated sample using the reject sample as an
empirical distribution function and the boundaries as a cost
function.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lhs_C</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/correlatedLHS.html">correlatedLHS</a></span><span class="op">(</span><span class="fu">lhs</span><span class="fu">::</span><span class="fu"><a href="../reference/randomLHS.html">randomLHS</a></span><span class="op">(</span><span class="fl">30</span>, <span class="fl">4</span><span class="op">)</span>,</span>
<span>                       marginal_transform_function <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">W</span>, <span class="va">empirical_sample</span>, <span class="va">...</span><span class="op">)</span> <span class="op">{</span></span>
<span>                         <span class="va">res</span> <span class="op">&lt;-</span> <span class="va">W</span></span>
<span>                         <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">W</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>                           <span class="va">res</span><span class="op">[</span>,<span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">empirical_sample</span><span class="op">[</span>,<span class="va">i</span><span class="op">]</span>, probs <span class="op">=</span> <span class="va">W</span><span class="op">[</span>,<span class="va">i</span><span class="op">]</span><span class="op">)</span></span>
<span>                         <span class="op">}</span></span>
<span>                         <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span>
<span>                       <span class="op">}</span>,</span>
<span>                       cost_function <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">W</span>, <span class="va">...</span><span class="op">)</span> <span class="op">{</span></span>
<span>                         <span class="va">p</span> <span class="op">&lt;-</span> <span class="va">W</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">*</span><span class="va">W</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">*</span><span class="va">W</span><span class="op">[</span>,<span class="fl">3</span><span class="op">]</span><span class="op">*</span><span class="va">W</span><span class="op">[</span>,<span class="fl">4</span><span class="op">]</span></span>
<span>                         <span class="va">pp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">p</span> <span class="op">&gt;</span> <span class="fl">0.3</span> <span class="op">&amp;</span> <span class="va">p</span> <span class="op">&lt;</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">W</span><span class="op">)</span></span>
<span>                         <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">pp</span><span class="op">)</span></span>
<span>                       <span class="op">}</span>,</span>
<span>                       debug <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                       maxiter <span class="op">=</span> <span class="fl">10000</span>,</span>
<span>                       empirical_sample <span class="op">=</span> <span class="va">reject_samp</span><span class="op">)</span></span></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Rob Carnell.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
